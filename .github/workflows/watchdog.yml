name: Watchdog Notification
on:
  workflow_run:
    workflows: ["Crave Builder(self-hosted)"]
    types: [completed]

jobs:
  alert:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' || github.event.workflow_run.conclusion == 'cancelled' }}
    steps:
      - name: Telegram Alert
        run: |
          curl -s -X POST https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage \
          -d chat_id=${{ secrets.TELEGRAM_TO }} \
          -d parse_mode=Markdown \
          -d text="‚ö†Ô∏è *WDALERT* %0A%0ARepo: ${{ github.repository }}%0ARama: ${{ github.event.workflow_run.head_branch }}%0AEstado: *${{ github.event.workflow_run.conclusion }}* üíÄ%0A%0ASi no hubo mensaje previo, f devspace."
